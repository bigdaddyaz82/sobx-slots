<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SOBX Slots with Real Payout</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #111;
      color: #fff;
    }

    h1 {
      margin-top: 30px;
      font-size: 2.5rem;
    }

    .slot-machine {
      display: flex;
      justify-content: center;
      margin-top: 50px;
      margin-bottom: 30px;
    }

    .symbol {
      width: 150px;
      height: 150px;
      border: 5px solid #fff;
      margin: 0 15px;
      font-size: 5rem;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #333;
      border-radius: 15px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg);}
      to { transform: rotate(360deg);}
    }

    button {
      padding: 15px 35px;
      font-size: 1.1rem;
      margin: 15px 10px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover:enabled {
      background-color: #218838;
    }

    button:disabled {
      background-color: #555;
      cursor: not-allowed;
    }

    #result {
      margin-top: 25px;
      font-size: 1.4rem;
      min-height: 30px;
    }

    .button-group {
      margin-top: 40px;
    }

    input[type="text"] {
      padding: 12px;
      width: 320px;
      font-size: 1.1rem;
      margin-top: 30px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .toggle-button.active {
      background-color: #ffc107 !important;
      color: #111 !important;
    }
  </style>
</head>
<body>
  <h1>SOBX Slot Machine</h1>

  <div class="slot-machine">
    <div class="symbol" id="symbol1">?</div>
    <div class="symbol" id="symbol2">?</div>
    <div class="symbol" id="symbol3">?</div>
  </div>

  <input type="text" id="wallet" placeholder="Enter wallet address" />
  <br />

  <div class="button-group">
    <button id="betBtn" class="toggle-button" onclick="toggleBet()">Bet OFF</button>
    <button id="multiplierBtn" class="toggle-button" onclick="toggleMultiplier()">×2 OFF</button>
    <button id="spinBtn" onclick="spin()" disabled>Spin</button>
  </div>

  <button onclick="connectWallet()">Connect Wallet</button>

  <div id="result"></div>

  <script>
    const symbols = [
      'cherry', 'lemon', 'orange', 'seven', 'bar', 
      'grape', 'diamond', 'skull', 'apple', 'parrot', 
      'horseshoe', 'clover', 'star'
    ];

    const emojiMap = {
      cherry: '🍒',
      lemon: '🍋',
      orange: '🍊',
      seven: '7️⃣',
      bar: '🍫',
      grape: '🍇',
      diamond: '💎',
      skull: '💀',
      apple: '🍎',
      parrot: '🦜',
      horseshoe: '🐎',
      clover: '🍀',
      star: '⭐'
    };

    let spinning = false;
    let betOn = false;
    let multiplierOn = false;

    const betBtn = document.getElementById('betBtn');
    const multiplierBtn = document.getElementById('multiplierBtn');
    const spinBtn = document.getElementById('spinBtn');

    function connectWallet() {
      const walletAddress = document.getElementById('wallet').value.trim();
      if (!walletAddress) {
        alert('Please enter your wallet address before connecting.');
        return;
      }
      alert('Wallet connected: ' + walletAddress);
    }

    function toggleBet() {
      betOn = !betOn;
      betBtn.textContent = betOn ? 'Bet ON' : 'Bet OFF';
      betBtn.classList.toggle('active', betOn);
      updateSpinButton();
    }

    function toggleMultiplier() {
      multiplierOn = !multiplierOn;
      multiplierBtn.textContent = multiplierOn ? '×2 ON' : '×2 OFF';
      multiplierBtn.classList.toggle('active', multiplierOn);
    }

    function updateSpinButton() {
      spinBtn.disabled = !betOn;
    }

    function spin() {
      if (spinning) return;
      const walletInput = document.getElementById('wallet').value.trim();
      if (!walletInput) {
        alert('Please enter your wallet address first.');
        return;
      }
      if (!betOn) {
        alert('Please turn Bet ON before spinning.');
        return;
      }

      spinning = true;
      document.getElementById('result').textContent = '';

      const symbolsEls = [
        document.getElementById('symbol1'),
        document.getElementById('symbol2'),
        document.getElementById('symbol3'),
      ];

      // Spin animation: random symbols every 100ms for 2 seconds
      let spinCount = 0;
      const maxSpins = 20;

      const spinInterval = setInterval(() => {
        spinCount++;
        symbolsEls.forEach(el => {
          const randSymbol = symbols[Math.floor(Math.random() * symbols.length)];
          el.textContent = emojiMap[randSymbol];
          el.dataset.currentSymbol = randSymbol;
        });

        if (spinCount >= maxSpins) {
          clearInterval(spinInterval);

          // Stop animation
          symbolsEls.forEach(el => {
            el.style.animationPlayState = 'paused';
          });

          // Calculate win based on house edge 80-20
          const houseEdge = 0.8; // House wins 80%
          const playerWins = Math.random() > houseEdge; // 20% chance to win

          const multiplier = multiplierOn ? 2 : 1;
          if (playerWins) {
            // You win: payout is 2x bet * multiplier
            const payout = 2 * multiplier;
            document.getElementById('result').textContent = `You win! Payout: ×${payout}`;
          } else {
            // You lose
            document.getElementById('result').textContent = 'You lose. House wins.';
          }

          spinning = false;
        }
      }, 100);
    }
  </script>
</body>
</html>
